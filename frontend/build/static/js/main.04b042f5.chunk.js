(this["webpackJsonpreact-todo-list"]=this["webpackJsonpreact-todo-list"]||[]).push([[0],{32:function(e,t,n){},33:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var r=n(18),a=n.n(r),c=(n(32),n(1)),s=(n(33),n(2)),i=n(8),l=n(4),o=n(9),u=n.n(o),j=n(12),b="ADD_TASK",d="DELETE_TASK",p="UPDATE_STATUS",O="EDIT_TASK",f="INIT_USER",m="LOGOUT",h=n(0);var x=function(){return Object(h.jsx)("button",{className:"btn waves-effect waves-light",type:"submit",name:"action",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})};var v=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.user._id})),n=Object(c.useRef)(),r=function(){var r=Object(j.a)(u.a.mark((function r(a){var c,s,i;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a.preventDefault(),""!==a.target.task.value){r.next=5;break}return r.abrupt("return",!1);case 5:return c=n.current.value,r.next=8,fetch("/list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:c,id:t})});case 8:return s=r.sent,r.next=11,s.json();case 11:i=r.sent,e({type:b,payload:i.newPost});case 13:a.target.reset();case 14:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"containerForm row",children:Object(h.jsx)("form",{onSubmit:r,className:"col s12",children:Object(h.jsx)("div",{className:"row",children:Object(h.jsxs)("div",{className:"input-field col s12",children:[Object(h.jsx)("label",{children:"\u0417\u0430\u0434\u0430\u0447\u0430"}),Object(h.jsx)("input",{ref:n,name:"task",type:"text",className:"validate"}),Object(h.jsx)(x,{})]})})})})},g=n(24);var y=function(e){var t=Object(s.b)(),n=function(){var e=Object(j.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/list",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n})});case 2:if(!e.sent.ok){e.next=7;break}t({type:p,payload:n}),e.next=8;break;case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)("button",{onClick:function(){n(e.id)},className:"btnCreate waves-effect waves-light btn-small",children:Object(h.jsx)("i",{className:"material-icons",children:"check"})})};var N=function(e){var t=Object(s.b)(),n=Object(s.c)((function(e){return e.user})),r=function(){var e=Object(j.a)(u.a.mark((function e(r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/list",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:r,idUser:n._id})});case 2:if(!e.sent.ok){e.next=7;break}t({type:d,payload:r}),e.next=8;break;case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)("button",{onClick:function(){r(e.id)},type:"submit",className:"btnDelete waves-effect waves-light btn-small",children:Object(h.jsx)("i",{className:"material-icons",children:"delete"})})};var k=function(e){var t=e.task,n=Object(c.useState)(!1),r=Object(g.a)(n,2),a=r[0],i=r[1],l=Object(c.useState)(t.title),o=Object(g.a)(l,2),b=o[0],d=o[1],p=Object(s.b)(),f=Object(c.useRef)(),m=function(){var e=Object(j.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""!==n.target.editTask.value){e.next=6;break}return i(!1),e.abrupt("return",!1);case 6:return e.next=8,fetch("/listOne",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:n.target.editTask.value,id:t._id})});case 8:e.sent.ok?(p({type:O,payload:{id:t._id,title:n.target.editTask.value}}),i(!1)):i(!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("li",{className:"collection-item ",children:[Object(h.jsx)(y,{id:t._id}),a?Object(h.jsx)("form",{onSubmit:m,children:Object(h.jsx)("input",{value:b,ref:f,onChange:function(){d(f.current.value)},name:"editTask",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"})}):Object(h.jsx)("p",{onClick:function(){i(!0)},className:t.status?"startImg red accent-1":"",children:t.title}),Object(h.jsx)(N,{id:t._id})]})};var w=function(){var e=Object(s.c)((function(e){return e.user.list}));return Object(h.jsx)(h.Fragment,{children:(null===e||void 0===e?void 0:e.length)?Object(h.jsx)("ul",{className:"collection",children:e.map((function(e){return Object(h.jsx)(k,{task:e},e._id)}))}):Object(h.jsx)("h3",{className:"textCenter",children:"\u041d\u0435\u0442 \u0417\u0430\u0434\u0430\u0447"})})};var T=function(){var e=Object(s.c)((function(e){return e.user}));return Object(h.jsx)(h.Fragment,{children:null!==e.user&&Object(h.jsxs)("div",{children:[Object(h.jsx)(v,{}),Object(h.jsx)(w,{})]})})};var S=function(){var e=Object(s.c)((function(e){return e.user})),t=Object(s.b)();return Object(h.jsx)("nav",{children:Object(h.jsxs)("div",{className:"nav-wrapper",children:[Object(h.jsx)(i.b,{className:"brand-logos",to:"/",children:"TODO"}),Object(h.jsxs)("ul",{id:"nav-mobile",className:"right",children:[Object(h.jsxs)("li",{children:[null!==e.user?Object(h.jsx)(i.b,{to:"/",children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"}):""," "]}),Object(h.jsxs)("li",{children:[null===e.user&&Object(h.jsx)(i.b,{to:"/registration",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})," "]}),Object(h.jsx)("li",{children:null===e.user&&Object(h.jsx)(i.b,{to:"/login",children:"\u0412\u043e\u0439\u0442\u0438"})}),Object(h.jsxs)("li",{children:[" ",null!==e.user&&Object(h.jsx)(i.b,{to:"/profile",children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"})]}),Object(h.jsx)("li",{children:null!==e.user?Object(h.jsx)(i.b,{onClick:function(){return t({type:"LOGOUT"})},to:"/",children:"\u0412\u044b\u0439\u0442\u0438 "}):""})]})]})})};var I=function(){var e=Object(s.b)(),t=Object(l.g)();return Object(h.jsx)("div",{className:"login container",children:Object(h.jsxs)("form",{onSubmit:function(n){n.preventDefault();var r={loginEmail:n.target.loginEmail.value,loginPassword:n.target.loginPassword.value};e(function(e){return function(t){fetch("/login",{method:"POST",headers:{"Content-Type":"Application/json"},body:JSON.stringify({logInfo:e})}).then((function(e){return e.json()})).then((function(e){if(e.message)throw new Error(e.message);return e})).then((function(e){return t({type:"INIT_USER",payload:e})})).then((function(e){return localStorage.setItem("token",e.payload.token)})).catch((function(e){return alert("".concat(e.message))}))}}(r)),t.push("/")},children:[Object(h.jsx)("div",{className:"mb-3",children:Object(h.jsx)("input",{type:"email",className:"form-control",id:"loginInputEmail1","aria-describedby":"emailHelp",placeholder:"Email",name:"loginEmail"})}),Object(h.jsx)("div",{className:"mb-3",children:Object(h.jsx)("input",{type:"password",className:"form-control",id:"loginInputPassword1",placeholder:"Password",name:"loginPassword"})}),Object(h.jsx)("button",{type:"submit",className:"btn btn-outline-dark bg-secondary loginButton",children:"\u0412\u043e\u0439\u0442\u0438"})]})})};var E=function(){var e=Object(l.g)(),t=Object(s.b)();return Object(h.jsx)("div",{className:"auth container ",children:Object(h.jsxs)("form",{onSubmit:function(n){if(n.preventDefault(),n.target.password.value===n.target.checkPassword.value){var r={name:n.target.name.value,email:n.target.email.value,password:n.target.password.value};t(function(e){return function(t){fetch("/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newUser:e})}).then((function(e){return e.json()})).then((function(e){return t({type:"INIT_USER",payload:e})})).then((function(e){return localStorage.setItem("token",e.payload.token)})).catch((function(e){return console.log(e)}))}}(r)),e.push("/")}else alert("\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u043b\u0438")},children:[Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("input",{type:"text",className:"form-control",id:"exampleInputName",placeholder:"\u0418\u043c\u044f",name:"name"}),Object(h.jsx)("div",{className:"mb-3",children:Object(h.jsx)("input",{type:"password",className:"form-control",id:"exampleInputPassword1",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password"})}),Object(h.jsx)("div",{className:"mb-3",children:Object(h.jsx)("input",{type:"password",className:"form-control",id:"exampleInputPassword2",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c \u0435\u0449\u0435 \u0440\u0430\u0437",name:"checkPassword"})}),Object(h.jsx)("div",{className:"mb-3",children:Object(h.jsx)("input",{type:"email",className:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp",placeholder:"Email",name:"email"})})]}),Object(h.jsx)("button",{type:"submit",className:"btn btn-outline-dark bg-secondary authButton",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]})})};var _=function(){return Object(h.jsxs)("div",{className:"divProfile",children:[Object(h.jsx)("h2",{className:"textCenter",children:"\u0412\u0430\u0448\u0438 \u0437\u0430\u0434\u0430\u0447\u0438"}),Object(h.jsx)(w,{})]})};var P=function(){var e=Object(s.c)((function(e){return e.user}));return Object(h.jsx)(l.b,{render:function(t){var n=t.location;return null!==e.user?Object(h.jsx)(_,{}):Object(h.jsx)(l.a,{to:{pathname:"/",state:{from:n}}})}})};var C=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.user}));return Object(c.useEffect)((function(){e((function(e){fetch("/auth",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){if(e.message)throw new Error(e.message);return e})).then((function(t){return e({type:"INIT_USER",payload:{user:t.user,token:t.token}})})).then((function(e){return localStorage.setItem("token",e.payload.token)})).catch((function(e){console.log(e),localStorage.removeItem("token")}))}))}),[e]),Object(h.jsx)(i.a,{children:Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(S,{}),null===t.user&&Object(h.jsx)("h1",{className:"textCenter",children:" \u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0438\u043b\u0438 \u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c"}),Object(h.jsxs)(l.d,{children:[Object(h.jsx)(l.b,{path:"/registration",component:E}),Object(h.jsx)(l.b,{path:"/login",component:I}),Object(h.jsx)(l.b,{path:"/",component:T,exact:!0}),Object(h.jsx)(P,{path:"/profile"})]})]})})},D=n(14),U=n(17),A=n(11),J={user:null};var R=Object(D.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return t.payload.user;case m:return localStorage.removeItem("token"),{user:null};case b:return Object(A.a)(Object(A.a)({},e),{},{list:[].concat(Object(U.a)(e.list),[t.payload])});case d:var n=Object(A.a)(Object(A.a)({},e),{},{list:Object(U.a)(e.list)}),r=n.list.filter((function(e){return e._id===t.payload})),a=n.list.indexOf(r[0]);return n.list.splice(a,1),n;case p:var c=Object(A.a)(Object(A.a)({},e),{},{list:Object(U.a)(e.list)}),s=c.list.filter((function(e){return e._id===t.payload})),i=c.list.indexOf(s[0]);return c.list[i].status?c.list[i].status=!1:c.list[i].status=!0,c;case O:var l=Object(A.a)(Object(A.a)({},e),{},{list:Object(U.a)(e.list)}),o=l.list.filter((function(e){return e._id===t.payload.id})),u=l.list.indexOf(o[0]);return l.list[u].title=t.payload.title,l;default:return e}}}),B=n(26),L=n(27),F=Object(D.createStore)(R,Object(B.composeWithDevTools)(Object(D.applyMiddleware)(L.a)));a.a.render(Object(h.jsx)(s.a,{store:F,children:Object(h.jsx)(C,{})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.04b042f5.chunk.js.map